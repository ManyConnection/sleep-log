default_platform(:ios)

platform :ios do
  desc "Build for App Store"
  lane :build do
    # Install pods if needed
    Dir.chdir("..") do
      sh("npx expo prebuild --platform ios --clean")
    end
    
    build_app(
      workspace: "./ios/waterdrinklog.xcworkspace",
      scheme: "waterdrinklog",
      export_method: "app-store",
      output_directory: "./build",
      output_name: "waterdrinklog.ipa"
    )
  end
end
